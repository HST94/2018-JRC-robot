代码修改记录：

1.2018.4.25：
	a.删除代码多余c文件，函数，变量，将传感器数据监控单独列为一个任务函数；
	b.利用printf在send_data_to_pc()函数中将机器人数据实时上传至上位机进行监控；

2.2018.05.05：
	a.增加robomodule有刷电机驱动器CAN总线通信，配置，及控制代码，根据推杆电机的霍尔反馈实现精确位置控制。
	 （推杆电机行程85mm，AB相霍尔四倍频后总共输出130000脉冲）
	b.删除代码多余未使用变量；重新定义了Robot_Move_Mode等变量；
	c.将SIYI遥控器面板的三挡开关定义为各种模式切换；实现SIYI遥控器摇杆控制推杆电机位置;
	d.将目标板晶振频率改为8M，在黑色单片机自组装集成板上进行了测试；

3.2018.05.06：
	a.将遥控器数据解析代码从接收中断函数中转移到主循环中的数据处理任务中；经测试，遥控器数据周期：每帧20ms；
	b.新建can1bustask.c和can2bustask.c文件，将哈尔滨驱动器控制放在can2总线，其余放在can1总线；
	c.增加can发送等待函数，发送成功则can发送中断函数将标志位置1，超过100us则自动返回；

4.2018.05.11：
	a.将晶振改成25M，并在机器人主控板上进行测试；
	b.将姿态反馈控制角度改为IMU的ROLL角度；
	b.和平衡轮驱动器通信测试成功，并将平衡轮ID号改为：左5号，右6号；姿态环测试成功；
	c.增加推杆电机限位开关读取；增加上下位置限制（编码器值下限：-90000，对应倾斜角度：10度）；

5.2018.05.12：
	a.增加有刷电机驱动器控制模式代码；
	b.修改CAN总线数据接收处理代码，将CAN1，CAN2总线接收数据单独处理；
	c.修改平衡轮升降控制代码，重新封装成一个控制函数，在履带控制任务中调用；
	d.增加摆腿控制代码；利用摆腿旋转电位器反馈，增加上下角度限位控制；

6.2018.05.13:
	a.修改姿态环PID参数；
	b.增加平衡模式下的转向环和速度环；三环同时运行时测试成功，实现遥控器控制转向及行走
	（在平衡点附近会震荡，原因：1.有机械虚位；2.驱动器换向速度不够快。）
	（单纯姿态环时，仅利用角度反馈控制时，机器人一边会着地。原因：可能是驱动器换向速度不够快。有待在实验室样机上进行测试。）
	c.增加履带控制，切换到履带模式时，可以通过遥控器进行行走速度控制。

7.2018.05.22:
	a.安装株洲改造电机后，履带行走测试成功；
	b.摆腿电机速度控制测试成功；
	c.平衡控制，履带控制，摆腿控制，推杆升降控制整合到不同任务，测试成功；

8.2018.05.23:
	a.调整履带电机参数，增大速度环比例和积分值，空载时稍有震荡，但是行走时效果较好；
	b.调整摆腿电机参数，增大速度环输出为4A；
	c.增加摆腿电位器角度检测，并将值转换到360度量纲；摆腿水平时标定为0度；增加摆腿上下角度限位，上80度，下-30度；
	d.调整平衡模式速度环与姿态环参数（整体重量大概130KG）；
	e.平衡控制，履带控制，摆腿控制，推杆升降控制等模式切换，整体测试成功；

9.2018.05.24：
	a.修改推杆电机驱动器CAN总线ID为：0组9号；
	b.增加云台旋转和俯仰控制测试代码，分别为0组8号和7号节点；
	c.增加机械臂单关节控制测试代码，分别为0组6号至1号节点；
	d.调整机械臂各个关节限位开关控制方向；
	e.调节机械臂各关节电机编码器反馈值与转速方向一致；

10.2018.05.27：
	a.将思翼遥控器面板四个三挡开关分别对应（右到左）：模式切换，摆腿控制，轮子摆腿切换，手臂云台切换；
	b.增加手臂摇杆数据处理函数，将遥控器通道数据映射到手臂摇杆结构体；

11.2018.05.28：
	a.调整pad控制数据，遥控器数据量程与控制箱一致，范围-127~+127；
	b.改进节点电机转速控制函数，将手臂与云台节点整合到一起，并且加入限位开关控制，作为底层通用函数调用；
	c.增加机械臂四轴角度控制函数，通过角度环PID算法控制四轴电机转速；
	d.改进机械臂联动控制算法，将一轴旋转加入到末端位置计算及控制，使得大臂旋转时仍能保持末端位置；
	e.改变机械臂位置环控制模式，以使能前位置为参考位置，目标位置为使能后摇杆的积分值，推杆结束后目标值清零，机械臂立即停止运动；
	f.增加联动时关节运动角度限制，某个关节超过阈值时立即停止运动；
	g.增加机械臂末端坐标位置限制，联动控制超过安全作业空间时停止运动；（单关节控制时超过阈值，切换到联动模式时此关节不会运动，否则会产生多解）
	h.增加4轴姿态保持控制，联动模式时4轴持续进行角度闭环控制，使得末端姿态保持不变；

12.2018.05.29：
	a.修改手臂腕部姿态保持控制代码，调节腕部角度闭环控制PID参数，使得跟踪更迅速稳定，测试效果良好；
	b.修改思翼遥控器控制量到手臂摇杆控制量的映射关系，左右摇杆垂直方向控制手臂直线运动，右手摇杆始终控制大臂旋转；
	c.修改联动控制代码，调整联动关节控制方向，取消单次位置积分限位，增大位置积分时间，增大最大规划速度；
	d.联动控制中加入其它关节单独控制；
	e.各个模块切换及控制基本完善，软件整体框架基本完成；

13.2018.05.30：
	a.增加机械臂一键伸展及复位代码；伸展时末端保持水平；复位时大臂旋转先回到零位，其它轴再收拢，避免碰到云台及摆腿；
	b.增加机械臂停止代码；
	c.增加机械臂运行模式变量，用来控制机械臂工作模式；
	d.机械臂单关节控制分为纯关节和末端保持两种模式，通过控制模式切换；
	e.增加末端姿态保持模式下，腕部角度调整功能，可按照调整后的角度继续保持姿态；

14.2018.05.31：
	a.测试并调整修改过的手臂控制程序，测试成功；
	b.修改bug，手臂一轴限位方向错误；
	a.增加控制箱控制数据接收及解析，并且赋予机器人各控制变量；调整各变量控制方向；测试成功；
	b.增加机器人状态数据上传，并且在控制箱显示屏显示；

15.2018.06.01：
	a.修改手臂联动时末端位置限位代码的一个bug，末端位置超过灵巧作业空间时，对单方向速度进行限制；
	b.增加控制箱数据零位死区限制，并且加大腕摆调节死区范围，避免末端位置保持时，保持角度对摇杆进行积分而改变；
	c.修改遥控数据处理任务框架，并将代码全部放到remotetask.c文件；
	d.增加遥控数据自动选择功能，若控制箱与机器人链接，则会选择控制箱数据，否则自动选择遥控器数据；
	e.修改遥控数据处理任务函数名称；

16.2018.06.05：
	a.将实验室测试机器人平衡电机拆下，更换掉平衡轮电机；
	b.修改姿态环与速度环PID参数，平衡效果有很大改善，可以接受但是仍然不够理想；

17.2.18.06.29：
	a.更换株洲定制的新的履带电机，测试通过；
	b.重新安装硬件后，履带，摆腿，推杆升降，平衡，手臂整体测试通过；
	c.优化手臂控制代码；增加3轴上软件限位；增加一键复位；修改复位角度逻辑；修改灵巧作业空间限制逻辑；修改腕摆姿态保持；

18.2018.06.30：
	a.增加手臂一键伸展功能；
	b.增加手臂一键到达预设抓取点功能；

19.2018.07.01：
	a.通过后伸机械臂调整重心，增加平衡控制，调整姿态环与速度环参数，效果较好；
	b.重新烧写履带驱动器程序，调整控制参数，过流保护不再出现，但是电机扭矩仍然不够；

20.2018.07.02：
	a.重新多次标定履带电机初始角度，确保每次变化在5度之内；
	b.增加腕转和夹钳控制，调试通过；

21.2018.07.04：
	a.增加控制箱控制数据解析，在串口1中进行；
	b.优化控制箱数据解析逻辑；调整死区控制，和遥控器达到一致；
	c.减小联动控制时位置积分时间；减小腕摆调整积分时间，解决之前出现腕摆不能及时停止bug；

22.2018.07.08：
	a.增加一键抓取控制流程；一键抓取并返回；一键放置并返回；

23.2018.07.10：
	a.将机械臂复位状态设置为收起状态；增加机械臂收起碰到限位开关时自动校准零位；
	b.完善优化一键抓取采样罐流程；
	c.车体所有设备安装完毕；重新标定平衡零位；修改平衡模式控制参数，增大姿态环参数，减小速度环参数；